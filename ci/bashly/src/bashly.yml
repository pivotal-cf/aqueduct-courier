name: tpi
help: App for provisioning and interacting with long-lived Shepherd environments, and storing the credentials in Vault.
version: 0.1.0
dependencies:
- bosh
- cf
- curl
- jq
- om
- pivnet
- shepherd
- smith
- vault
commands:
- name: list
  help: List Shepherd environments owned my our team
  flags:
  - long: --json
    help: Return environments as JSON
  examples:
  - tpi list

- name: create
  help: Create a long-lived environment using Shepherd
  args:
  - name: foundation
    required: true
    help: foundation to create
    allowed: [production-jammy, acceptance-jammy, staging-jammy, production-xenial, acceptance-xenial, staging-xenial]
  examples:
  - tpi create acceptance-jammy

- name: install
  help: Install the Telemetry Tile on the specified environment
  args:
  - name: foundation
    required: true
    help: foundation to install Telemetry Tile on
    allowed: [production-jammy, acceptance-jammy, production-xenial, acceptance-xenial]
  examples:
  - tpi install acceptance-jammy

- name: update
  help: Upload secrets to Vault
  args:
  - name: foundation
    required: true
    help: foundation to update Vault Secrets for
    allowed: [production-jammy, acceptance-jammy, staging-jammy, production-xenial, acceptance-xenial, staging-xenial]
  examples:
  - tpi update acceptance-jammy

- name: print
  help: Print telemetry_cli commands
  args:
  - name: foundation
    required: true
    help: foundation to print telemetry CLI commands of
    allowed: [production-jammy, acceptance-jammy, staging-jammy, production-xenial, acceptance-xenial, staging-xenial]
  flags:
  - long: --collect
    help: Return environments as JSON
  examples:
  - tpi print acceptance-jammy

- name: get
  help: Get lockfile for foundation, write to local filesystem, and source for cf cli
  args:
  - name: foundation
    required: true
    help: foundation to get details for
    allowed: [production-jammy, acceptance-jammy, staging-jammy, production-xenial, acceptance-xenial, staging-xenial, telemetry-release-audit-false-jammy, telemetry-release-audit-true-jammy, p-telemetry-audit-false-jammy, p-telemetry-audit-true-jammy, telemetry-release-audit-false-xenial, telemetry-release-audit-true-xenial, p-telemetry-audit-false-xenial, p-telemetry-audit-true-xenial]
  examples:
  - tpi get acceptance-jammy

- name: open
  help: Open foundation
  args:
  - name: foundation
    required: true
    help: foundation to open
    allowed: [production-jammy, acceptance-jammy, staging-jammy, production-xenial, acceptance-xenial, staging-xenial, telemetry-release-jammy]
  examples:
  - tpi open acceptance-jammy

- name: whoami
  help: The foundation that is currently targeted
  examples:
  - tpi whoami

- name: maintain
  help: Ensure that all CI environments exist. Create any needed. Install the Telemetry Tile if needed. Upload secretes to Vault.
  examples:
  - tpi maintain

